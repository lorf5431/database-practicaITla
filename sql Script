
CREATE DATABASE GestionFeedback;
GO

USE GestionFeedback;
GO

CREATE TABLE clients (
    client_id INT IDENTITY(1,1) PRIMARY KEY,
    nombre VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL
);

CREATE TABLE products (
    product_id INT IDENTITY(1,1) PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    categoria VARCHAR(100) NOT NULL
);


CREATE TABLE surveys (
    survey_id INT IDENTITY(1,1) PRIMARY KEY,
    client_id INT NOT NULL,
    idProducto INT NOT NULL,
    fecha DATE NOT NULL,
    comentario TEXT NOT NULL,
    clasificacion VARCHAR(50) NOT NULL,
    puntajeSastifacion FLOAT CHECK (puntajeSastifacion BETWEEN 0 AND 10),
    
    CONSTRAINT FK_Surveys_Clients 
        FOREIGN KEY (client_id) REFERENCES clients(client_id),
    CONSTRAINT FK_Surveys_Products 
        FOREIGN KEY (idProducto) REFERENCES products(product_id)
);

CREATE TABLE fuentes (
    fuente_id INT IDENTITY(1,1) PRIMARY KEY,
    tipo_fuente VARCHAR(100) NOT NULL
);


CREATE TABLE fuente_dato (
    carga_id INT IDENTITY(1,1) PRIMARY KEY,
    fuente_id INT NOT NULL,
    fecha_carga DATETIME DEFAULT GETDATE(),

    CONSTRAINT FK_FuenteDato_Fuentes
        FOREIGN KEY (fuente_id) REFERENCES fuentes(fuente_id)
);


CREATE TABLE platforms (
    platform_id INT IDENTITY(1,1) PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);



CREATE TABLE social_comments (
    comment_id INT IDENTITY(1,1) PRIMARY KEY,
    client_id INT NOT NULL,
    product_id INT NOT NULL,
    platform_id INT NOT NULL,
    comment_text TEXT NOT NULL,
    rating INT CHECK (rating BETWEEN 1 AND 5),
    fecha DATETIME DEFAULT GETDATE(),

    CONSTRAINT FK_SocialComments_Clients 
        FOREIGN KEY (client_id) REFERENCES clients(client_id),
    CONSTRAINT FK_SocialComments_Products 
        FOREIGN KEY (product_id) REFERENCES products(product_id),
    CONSTRAINT FK_SocialComments_Platforms
        FOREIGN KEY (platform_id) REFERENCES platforms(platform_id)
);


CREATE TABLE web_reviews (
    review_id INT IDENTITY(1,1) PRIMARY KEY,
    client_id INT NOT NULL,
    product_id INT NOT NULL,
    fuente_id INT NOT NULL,
    fecha DATE NOT NULL,
    comentario TEXT NOT NULL,

    CONSTRAINT FK_WebReviews_Clients 
        FOREIGN KEY (client_id) REFERENCES clients(client_id),
    CONSTRAINT FK_WebReviews_Products 
        FOREIGN KEY (product_id) REFERENCES products(product_id),
    CONSTRAINT FK_WebReviews_Fuentes
        FOREIGN KEY (fuente_id) REFERENCES fuentes(fuente_id)
);
